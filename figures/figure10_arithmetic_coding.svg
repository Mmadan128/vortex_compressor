<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: arithmetic_coding Pages: 1 -->
<svg width="451pt" height="696pt"
 viewBox="0.00 0.00 451.00 696.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 692)">
<title>arithmetic_coding</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-692 447,-692 447,4 -4,4"/>
<text text-anchor="middle" x="221.5" y="-671.2" font-family="Arial" font-size="16.00">Arithmetic Coding: Probability to Bits</text>
<!-- logits -->
<g id="node1" class="node">
<title>logits</title>
<path fill="#e1f5ff" stroke="black" d="M234.5,-647C234.5,-647 101.5,-647 101.5,-647 95.5,-647 89.5,-641 89.5,-635 89.5,-635 89.5,-606 89.5,-606 89.5,-600 95.5,-594 101.5,-594 101.5,-594 234.5,-594 234.5,-594 240.5,-594 246.5,-600 246.5,-606 246.5,-606 246.5,-635 246.5,-635 246.5,-641 240.5,-647 234.5,-647"/>
<text text-anchor="middle" x="168" y="-631.8" font-family="Arial" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="168" y="-616.8" font-family="Arial" font-size="14.00">Logits [batch, 512, 256]</text>
<text text-anchor="middle" x="168" y="-601.8" font-family="Arial" font-size="14.00">Raw scores</text>
</g>
<!-- softmax -->
<g id="node2" class="node">
<title>softmax</title>
<path fill="#ccccff" stroke="black" d="M233.5,-543C233.5,-543 102.5,-543 102.5,-543 96.5,-543 90.5,-537 90.5,-531 90.5,-531 90.5,-502 90.5,-502 90.5,-496 96.5,-490 102.5,-490 102.5,-490 233.5,-490 233.5,-490 239.5,-490 245.5,-496 245.5,-502 245.5,-502 245.5,-531 245.5,-531 245.5,-537 239.5,-543 233.5,-543"/>
<text text-anchor="middle" x="168" y="-527.8" font-family="Arial" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="168" y="-512.8" font-family="Arial" font-size="14.00">Convert to probabilities</text>
<text text-anchor="middle" x="168" y="-497.8" font-family="Arial" font-size="14.00">Σ p(x) = 1</text>
</g>
<!-- logits&#45;&gt;softmax -->
<g id="edge1" class="edge">
<title>logits&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M168,-593.76C168,-581.56 168,-566.78 168,-553.49"/>
<polygon fill="black" stroke="black" points="171.5,-553.23 168,-543.23 164.5,-553.23 171.5,-553.23"/>
</g>
<!-- example -->
<g id="node3" class="node">
<title>example</title>
<polygon fill="#ffffee" stroke="black" points="154,-439 0,-439 0,-401 160,-401 160,-433 154,-439"/>
<polyline fill="none" stroke="black" points="154,-439 154,-433 "/>
<polyline fill="none" stroke="black" points="160,-433 154,-433 "/>
<text text-anchor="middle" x="80" y="-423.8" font-family="Arial" font-size="14.00">Example for byte 147:</text>
<text text-anchor="middle" x="80" y="-408.8" font-family="Arial" font-size="14.00">p(147 | context) = 0.089</text>
</g>
<!-- softmax&#45;&gt;example -->
<g id="edge2" class="edge">
<title>softmax&#45;&gt;example</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M143.95,-489.68C131.45,-476.25 116.21,-459.89 103.75,-446.5"/>
<polygon fill="black" stroke="black" points="106.15,-443.94 96.77,-439.01 101.03,-448.71 106.15,-443.94"/>
</g>
<!-- cdf -->
<g id="node4" class="node">
<title>cdf</title>
<path fill="#ccffcc" stroke="black" d="M322,-454C322,-454 190,-454 190,-454 184,-454 178,-448 178,-442 178,-442 178,-398 178,-398 178,-392 184,-386 190,-386 190,-386 322,-386 322,-386 328,-386 334,-392 334,-398 334,-398 334,-442 334,-442 334,-448 328,-454 322,-454"/>
<text text-anchor="middle" x="256" y="-438.8" font-family="Arial" font-size="14.00">Cumulative Distribution</text>
<text text-anchor="middle" x="256" y="-423.8" font-family="Arial" font-size="14.00">CDF[i] = Σ(j=0 to i) p(j)</text>
<text text-anchor="middle" x="256" y="-408.8" font-family="Arial" font-size="14.00">CDF[147] = 0.412</text>
<text text-anchor="middle" x="256" y="-393.8" font-family="Arial" font-size="14.00">CDF[148] = 0.501</text>
</g>
<!-- softmax&#45;&gt;cdf -->
<g id="edge3" class="edge">
<title>softmax&#45;&gt;cdf</title>
<path fill="none" stroke="black" d="M192.05,-489.68C200.08,-481.05 209.23,-471.22 218.06,-461.74"/>
<polygon fill="black" stroke="black" points="220.78,-463.95 225.04,-454.25 215.66,-459.18 220.78,-463.95"/>
</g>
<!-- interval -->
<g id="node5" class="node">
<title>interval</title>
<path fill="#ffffcc" stroke="black" d="M331.5,-350C331.5,-350 180.5,-350 180.5,-350 174.5,-350 168.5,-344 168.5,-338 168.5,-338 168.5,-309 168.5,-309 168.5,-303 174.5,-297 180.5,-297 180.5,-297 331.5,-297 331.5,-297 337.5,-297 343.5,-303 343.5,-309 343.5,-309 343.5,-338 343.5,-338 343.5,-344 337.5,-350 331.5,-350"/>
<text text-anchor="middle" x="256" y="-334.8" font-family="Arial" font-size="14.00">Interval Encoding</text>
<text text-anchor="middle" x="256" y="-319.8" font-family="Arial" font-size="14.00">Byte 147 → [0.412, 0.501)</text>
<text text-anchor="middle" x="256" y="-304.8" font-family="Arial" font-size="14.00">Interval width = 0.089</text>
</g>
<!-- cdf&#45;&gt;interval -->
<g id="edge4" class="edge">
<title>cdf&#45;&gt;interval</title>
<path fill="none" stroke="black" d="M256,-385.95C256,-377.72 256,-368.85 256,-360.48"/>
<polygon fill="black" stroke="black" points="259.5,-360.24 256,-350.24 252.5,-360.24 259.5,-360.24"/>
</g>
<!-- bits -->
<g id="node6" class="node">
<title>bits</title>
<path fill="#90ee90" stroke="black" d="M320.5,-261C320.5,-261 191.5,-261 191.5,-261 185.5,-261 179.5,-255 179.5,-249 179.5,-249 179.5,-205 179.5,-205 179.5,-199 185.5,-193 191.5,-193 191.5,-193 320.5,-193 320.5,-193 326.5,-193 332.5,-199 332.5,-205 332.5,-205 332.5,-249 332.5,-249 332.5,-255 326.5,-261 320.5,-261"/>
<text text-anchor="middle" x="256" y="-245.8" font-family="Arial" font-size="14.00">Bits Required</text>
<text text-anchor="middle" x="256" y="-230.8" font-family="Arial" font-size="14.00">&#45;log₂(0.089) ≈ 3.49 bits</text>
<text text-anchor="middle" x="256" y="-215.8" font-family="Arial" font-size="14.00">vs 8 bits (fixed)</text>
<text text-anchor="middle" x="256" y="-200.8" font-family="Arial" font-size="14.00">Savings: 4.51 bits!</text>
</g>
<!-- interval&#45;&gt;bits -->
<g id="edge5" class="edge">
<title>interval&#45;&gt;bits</title>
<path fill="none" stroke="black" d="M256,-296.68C256,-288.82 256,-279.96 256,-271.29"/>
<polygon fill="black" stroke="black" points="259.5,-271.25 256,-261.25 252.5,-271.25 259.5,-271.25"/>
</g>
<!-- torchac -->
<g id="node7" class="node">
<title>torchac</title>
<path fill="#ffe1cc" stroke="black" d="M342.5,-157C342.5,-157 169.5,-157 169.5,-157 163.5,-157 157.5,-151 157.5,-145 157.5,-145 157.5,-101 157.5,-101 157.5,-95 163.5,-89 169.5,-89 169.5,-89 342.5,-89 342.5,-89 348.5,-89 354.5,-95 354.5,-101 354.5,-101 354.5,-145 354.5,-145 354.5,-151 348.5,-157 342.5,-157"/>
<text text-anchor="middle" x="256" y="-141.8" font-family="Arial" font-size="14.00">torchac Library</text>
<text text-anchor="middle" x="256" y="-126.8" font-family="Arial" font-size="14.00">Range coding implementation</text>
<text text-anchor="middle" x="256" y="-111.8" font-family="Arial" font-size="14.00">16&#45;bit precision</text>
<text text-anchor="middle" x="256" y="-96.8" font-family="Arial" font-size="14.00">Near&#45;optimal encoding</text>
</g>
<!-- bits&#45;&gt;torchac -->
<g id="edge6" class="edge">
<title>bits&#45;&gt;torchac</title>
<path fill="none" stroke="black" d="M256,-192.88C256,-184.78 256,-175.98 256,-167.47"/>
<polygon fill="black" stroke="black" points="259.5,-167.3 256,-157.3 252.5,-167.3 259.5,-167.3"/>
</g>
<!-- bitstream -->
<g id="node8" class="node">
<title>bitstream</title>
<path fill="#e1ffe1" stroke="black" stroke-width="3" d="M347,-53C347,-53 165,-53 165,-53 159,-53 153,-47 153,-41 153,-41 153,-12 153,-12 153,-6 159,0 165,0 165,0 347,0 347,0 353,0 359,-6 359,-12 359,-12 359,-41 359,-41 359,-47 353,-53 347,-53"/>
<text text-anchor="middle" x="256" y="-37.8" font-family="Arial" font-size="14.00">Compressed Bitstream</text>
<text text-anchor="middle" x="256" y="-22.8" font-family="Arial" font-size="14.00">Average: 3.04 bits/byte</text>
<text text-anchor="middle" x="256" y="-7.8" font-family="Arial" font-size="14.00">Theoretical: 2.63× compression</text>
</g>
<!-- torchac&#45;&gt;bitstream -->
<g id="edge7" class="edge">
<title>torchac&#45;&gt;bitstream</title>
<path fill="none" stroke="black" d="M256,-88.95C256,-80.72 256,-71.85 256,-63.48"/>
<polygon fill="black" stroke="black" points="259.5,-63.24 256,-53.24 252.5,-63.24 259.5,-63.24"/>
</g>
<!-- theory -->
<g id="node9" class="node">
<title>theory</title>
<polygon fill="#ffffdd" stroke="black" points="437,-662 265,-662 265,-579 443,-579 443,-656 437,-662"/>
<polyline fill="none" stroke="black" points="437,-662 437,-656 "/>
<polyline fill="none" stroke="black" points="443,-656 437,-656 "/>
<text text-anchor="middle" x="354" y="-646.8" font-family="Arial" font-size="14.00">Shannon&#39;s Theorem:</text>
<text text-anchor="middle" x="354" y="-631.8" font-family="Arial" font-size="14.00">Optimal bits = &#45;log₂ p(x)</text>
<text text-anchor="middle" x="354" y="-616.8" font-family="Arial" font-size="14.00">Arithmetic coding achieves</text>
<text text-anchor="middle" x="354" y="-601.8" font-family="Arial" font-size="14.00">near&#45;optimal compression</text>
<text text-anchor="middle" x="354" y="-586.8" font-family="Arial" font-size="14.00">with &lt; 2 bits overhead</text>
</g>
</g>
</svg>
