<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: compressive_attention Pages: 1 -->
<svg width="1500pt" height="290pt"
 viewBox="0.00 0.00 1500.00 290.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 286)">
<title>compressive_attention</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-286 1496,-286 1496,4 -4,4"/>
<text text-anchor="middle" x="746" y="-265.2" font-family="Arial" font-size="16.00">Compressive Attention Memory Mechanism</text>
<g id="clust1" class="cluster">
<title>cluster_memory</title>
<polygon fill="#f5f5f5" stroke="black" points="716,-8 716,-190 902,-190 902,-8 716,-8"/>
<text text-anchor="middle" x="809" y="-173.2" font-family="Arial" font-size="16.00">Memory Buffers</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_compress</title>
<polygon fill="#fff8e1" stroke="black" points="30.5,-70 30.5,-180 643,-180 643,-70 30.5,-70"/>
<text text-anchor="middle" x="336.75" y="-163.2" font-family="Arial" font-size="16.00">Compression Process</text>
</g>
<!-- compressed -->
<g id="node1" class="node">
<title>compressed</title>
<path fill="#ffe1e1" stroke="black" d="M882,-156C882,-156 736,-156 736,-156 730,-156 724,-150 724,-144 724,-144 724,-100 724,-100 724,-94 730,-88 736,-88 736,-88 882,-88 882,-88 888,-88 894,-94 894,-100 894,-100 894,-144 894,-144 894,-150 888,-156 882,-156"/>
<text text-anchor="middle" x="809" y="-140.8" font-family="Arial" font-size="14.00">Compressed Memory</text>
<text text-anchor="middle" x="809" y="-125.8" font-family="Arial" font-size="14.00">Up to 512 tokens</text>
<text text-anchor="middle" x="809" y="-110.8" font-family="Arial" font-size="14.00">(represents 2048 original)</text>
<text text-anchor="middle" x="809" y="-95.8" font-family="Arial" font-size="14.00">4:1 compression</text>
</g>
<!-- concatenate -->
<g id="node6" class="node">
<title>concatenate</title>
<path fill="#d0e0ff" stroke="black" d="M1152,-111.5C1152,-111.5 1012,-111.5 1012,-111.5 1006,-111.5 1000,-105.5 1000,-99.5 1000,-99.5 1000,-70.5 1000,-70.5 1000,-64.5 1006,-58.5 1012,-58.5 1012,-58.5 1152,-58.5 1152,-58.5 1158,-58.5 1164,-64.5 1164,-70.5 1164,-70.5 1164,-99.5 1164,-99.5 1164,-105.5 1158,-111.5 1152,-111.5"/>
<text text-anchor="middle" x="1082" y="-96.3" font-family="Arial" font-size="14.00">Concatenate</text>
<text text-anchor="middle" x="1082" y="-81.3" font-family="Arial" font-size="14.00">Compressed + Recent</text>
<text text-anchor="middle" x="1082" y="-66.3" font-family="Arial" font-size="14.00">Total context: up to 2560</text>
</g>
<!-- compressed&#45;&gt;concatenate -->
<g id="edge5" class="edge">
<title>compressed&#45;&gt;concatenate</title>
<path fill="none" stroke="black" d="M894.26,-110.5C924.41,-106.38 958.54,-101.72 989.29,-97.52"/>
<polygon fill="black" stroke="black" points="990.14,-100.94 999.58,-96.12 989.19,-94 990.14,-100.94"/>
<text text-anchor="middle" x="947" y="-125.8" font-family="Times,serif" font-size="14.00">long&#45;term</text>
<text text-anchor="middle" x="947" y="-110.8" font-family="Times,serif" font-size="14.00">context</text>
</g>
<!-- recent -->
<g id="node2" class="node">
<title>recent</title>
<path fill="#e1ffe1" stroke="black" d="M853.5,-69.5C853.5,-69.5 764.5,-69.5 764.5,-69.5 758.5,-69.5 752.5,-63.5 752.5,-57.5 752.5,-57.5 752.5,-28.5 752.5,-28.5 752.5,-22.5 758.5,-16.5 764.5,-16.5 764.5,-16.5 853.5,-16.5 853.5,-16.5 859.5,-16.5 865.5,-22.5 865.5,-28.5 865.5,-28.5 865.5,-57.5 865.5,-57.5 865.5,-63.5 859.5,-69.5 853.5,-69.5"/>
<text text-anchor="middle" x="809" y="-54.3" font-family="Arial" font-size="14.00">Recent Memory</text>
<text text-anchor="middle" x="809" y="-39.3" font-family="Arial" font-size="14.00">512 tokens</text>
<text text-anchor="middle" x="809" y="-24.3" font-family="Arial" font-size="14.00">Full resolution</text>
</g>
<!-- old_tokens -->
<g id="node3" class="node">
<title>old_tokens</title>
<path fill="#ffffcc" stroke="black" d="M171.5,-123C171.5,-123 50.5,-123 50.5,-123 44.5,-123 38.5,-117 38.5,-111 38.5,-111 38.5,-97 38.5,-97 38.5,-91 44.5,-85 50.5,-85 50.5,-85 171.5,-85 171.5,-85 177.5,-85 183.5,-91 183.5,-97 183.5,-97 183.5,-111 183.5,-111 183.5,-117 177.5,-123 171.5,-123"/>
<text text-anchor="middle" x="111" y="-107.8" font-family="Arial" font-size="14.00">Oldest 128 tokens</text>
<text text-anchor="middle" x="111" y="-92.8" font-family="Arial" font-size="14.00">from Recent Memory</text>
</g>
<!-- recent&#45;&gt;old_tokens -->
<g id="edge1" class="edge">
<title>recent&#45;&gt;old_tokens</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M752.35,-42.22C652.84,-41.59 438.04,-43.67 259,-69 236.47,-72.19 212.34,-77.23 190.28,-82.51"/>
<polygon fill="black" stroke="black" points="189.18,-79.17 180.3,-84.94 190.84,-85.97 189.18,-79.17"/>
<text text-anchor="middle" x="430.5" y="-57.8" font-family="Times,serif" font-size="14.00">when full</text>
</g>
<!-- recent&#45;&gt;concatenate -->
<g id="edge6" class="edge">
<title>recent&#45;&gt;concatenate</title>
<path fill="none" stroke="black" d="M865.53,-49.07C899.3,-53.02 943.24,-58.61 982,-65 984.54,-65.42 987.11,-65.85 989.7,-66.3"/>
<polygon fill="black" stroke="black" points="989.32,-69.79 999.78,-68.1 990.55,-62.9 989.32,-69.79"/>
<text text-anchor="middle" x="947" y="-83.8" font-family="Times,serif" font-size="14.00">recent</text>
<text text-anchor="middle" x="947" y="-68.8" font-family="Times,serif" font-size="14.00">context</text>
</g>
<!-- conv1d -->
<g id="node4" class="node">
<title>conv1d</title>
<path fill="#ffe0b0" stroke="black" d="M367,-146C367,-146 271,-146 271,-146 265,-146 259,-140 259,-134 259,-134 259,-90 259,-90 259,-84 265,-78 271,-78 271,-78 367,-78 367,-78 373,-78 379,-84 379,-90 379,-90 379,-134 379,-134 379,-140 373,-146 367,-146"/>
<text text-anchor="middle" x="319" y="-130.8" font-family="Arial" font-size="14.00">Conv1D Layer</text>
<text text-anchor="middle" x="319" y="-115.8" font-family="Arial" font-size="14.00">kernel_size=4</text>
<text text-anchor="middle" x="319" y="-100.8" font-family="Arial" font-size="14.00">stride=4</text>
<text text-anchor="middle" x="319" y="-85.8" font-family="Arial" font-size="14.00">512 in â†’ 512 out</text>
</g>
<!-- old_tokens&#45;&gt;conv1d -->
<g id="edge2" class="edge">
<title>old_tokens&#45;&gt;conv1d</title>
<path fill="none" stroke="black" d="M183.76,-106.79C204.81,-107.6 227.79,-108.5 248.69,-109.31"/>
<polygon fill="black" stroke="black" points="248.64,-112.81 258.77,-109.7 248.91,-105.81 248.64,-112.81"/>
</g>
<!-- compressed_tokens -->
<g id="node5" class="node">
<title>compressed_tokens</title>
<path fill="#ffcc99" stroke="black" d="M623,-139C623,-139 494,-139 494,-139 488,-139 482,-133 482,-127 482,-127 482,-113 482,-113 482,-107 488,-101 494,-101 494,-101 623,-101 623,-101 629,-101 635,-107 635,-113 635,-113 635,-127 635,-127 635,-133 629,-139 623,-139"/>
<text text-anchor="middle" x="558.5" y="-123.8" font-family="Arial" font-size="14.00">32 compressed tokens</text>
<text text-anchor="middle" x="558.5" y="-108.8" font-family="Arial" font-size="14.00">(4:1 ratio)</text>
</g>
<!-- conv1d&#45;&gt;compressed_tokens -->
<g id="edge3" class="edge">
<title>conv1d&#45;&gt;compressed_tokens</title>
<path fill="none" stroke="black" d="M379.01,-113.99C406.91,-114.93 440.75,-116.07 471.43,-117.1"/>
<polygon fill="black" stroke="black" points="471.59,-120.61 481.7,-117.45 471.83,-113.61 471.59,-120.61"/>
</g>
<!-- compressed_tokens&#45;&gt;compressed -->
<g id="edge4" class="edge">
<title>compressed_tokens&#45;&gt;compressed</title>
<path fill="none" stroke="black" d="M635.07,-120.61C659.78,-120.81 687.54,-121.03 713.46,-121.24"/>
<polygon fill="black" stroke="black" points="713.65,-124.74 723.68,-121.32 713.71,-117.74 713.65,-124.74"/>
<text text-anchor="middle" x="679.5" y="-124.8" font-family="Times,serif" font-size="14.00">append</text>
</g>
<!-- attention -->
<g id="node7" class="node">
<title>attention</title>
<path fill="#c0d0ff" stroke="black" d="M1328,-119C1328,-119 1213,-119 1213,-119 1207,-119 1201,-113 1201,-107 1201,-107 1201,-63 1201,-63 1201,-57 1207,-51 1213,-51 1213,-51 1328,-51 1328,-51 1334,-51 1340,-57 1340,-63 1340,-63 1340,-107 1340,-107 1340,-113 1334,-119 1328,-119"/>
<text text-anchor="middle" x="1270.5" y="-103.8" font-family="Arial" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1270.5" y="-88.8" font-family="Arial" font-size="14.00">8 heads, d_k=64</text>
<text text-anchor="middle" x="1270.5" y="-73.8" font-family="Arial" font-size="14.00">Scaled dot&#45;product</text>
<text text-anchor="middle" x="1270.5" y="-58.8" font-family="Arial" font-size="14.00">+ Causal mask</text>
</g>
<!-- concatenate&#45;&gt;attention -->
<g id="edge7" class="edge">
<title>concatenate&#45;&gt;attention</title>
<path fill="none" stroke="black" d="M1164.26,-85C1173.01,-85 1181.9,-85 1190.62,-85"/>
<polygon fill="black" stroke="black" points="1190.76,-88.5 1200.76,-85 1190.76,-81.5 1190.76,-88.5"/>
</g>
<!-- output_node -->
<g id="node8" class="node">
<title>output_node</title>
<path fill="#e1ffe1" stroke="black" d="M1480,-111.5C1480,-111.5 1389,-111.5 1389,-111.5 1383,-111.5 1377,-105.5 1377,-99.5 1377,-99.5 1377,-70.5 1377,-70.5 1377,-64.5 1383,-58.5 1389,-58.5 1389,-58.5 1480,-58.5 1480,-58.5 1486,-58.5 1492,-64.5 1492,-70.5 1492,-70.5 1492,-99.5 1492,-99.5 1492,-105.5 1486,-111.5 1480,-111.5"/>
<text text-anchor="middle" x="1434.5" y="-96.3" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1434.5" y="-81.3" font-family="Arial" font-size="14.00">Context&#45;aware</text>
<text text-anchor="middle" x="1434.5" y="-66.3" font-family="Arial" font-size="14.00">representations</text>
</g>
<!-- attention&#45;&gt;output_node -->
<g id="edge8" class="edge">
<title>attention&#45;&gt;output_node</title>
<path fill="none" stroke="black" d="M1340.2,-85C1349,-85 1358,-85 1366.77,-85"/>
<polygon fill="black" stroke="black" points="1366.94,-88.5 1376.94,-85 1366.94,-81.5 1366.94,-88.5"/>
</g>
<!-- note -->
<g id="node9" class="node">
<title>note</title>
<polygon fill="#ffffdd" stroke="black" points="216,-256 0,-256 0,-188 222,-188 222,-250 216,-256"/>
<polyline fill="none" stroke="black" points="216,-256 216,-250 "/>
<polyline fill="none" stroke="black" points="222,-250 216,-250 "/>
<text text-anchor="middle" x="111" y="-240.8" font-family="Arial" font-size="14.00">Effective Context Window:</text>
<text text-anchor="middle" x="111" y="-225.8" font-family="Arial" font-size="14.00">512 (recent) + 2048 (compressed)</text>
<text text-anchor="middle" x="111" y="-210.8" font-family="Arial" font-size="14.00">= 2560 bytes history</text>
<text text-anchor="middle" x="111" y="-195.8" font-family="Arial" font-size="14.00">with O(1) memory growth</text>
</g>
</g>
</svg>
