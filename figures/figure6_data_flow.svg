<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: data_flow Pages: 1 -->
<svg width="487pt" height="795pt"
 viewBox="0.00 0.00 487.00 794.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 790.5)">
<title>data_flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-790.5 483,-790.5 483,4 -4,4"/>
<text text-anchor="middle" x="239.5" y="-769.7" font-family="Arial" font-size="16.00">Complete Data Flow: Training to Evaluation</text>
<g id="clust1" class="cluster">
<title>cluster_data</title>
<polygon fill="#e1f5ff" stroke="black" points="67,-582.5 67,-752.5 429,-752.5 429,-582.5 67,-582.5"/>
<text text-anchor="middle" x="248" y="-735.7" font-family="Arial" font-size="16.00">ATLAS Data</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_training</title>
<polygon fill="#eeffee" stroke="black" points="224,-8 224,-337 471,-337 471,-8 224,-8"/>
<text text-anchor="middle" x="347.5" y="-320.2" font-family="Arial" font-size="16.00">Training Loop</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_eval</title>
<polygon fill="#eeeeff" stroke="black" points="29,-249.5 29,-458.5 209,-458.5 209,-249.5 29,-249.5"/>
<text text-anchor="middle" x="119" y="-441.7" font-family="Arial" font-size="16.00">Evaluation</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_results</title>
<polygon fill="#e1ffe1" stroke="black" points="8,-8 8,-223 216,-223 216,-8 8,-8"/>
<text text-anchor="middle" x="112" y="-206.2" font-family="Arial" font-size="16.00">Results</text>
</g>
<!-- raw_data -->
<g id="node1" class="node">
<title>raw_data</title>
<path fill="#d0e8ff" stroke="black" d="M327,-718.5C327,-718.5 169,-718.5 169,-718.5 163,-718.5 157,-712.5 157,-706.5 157,-706.5 157,-677.5 157,-677.5 157,-671.5 163,-665.5 169,-665.5 169,-665.5 327,-665.5 327,-665.5 333,-665.5 339,-671.5 339,-677.5 339,-677.5 339,-706.5 339,-706.5 339,-712.5 333,-718.5 327,-718.5"/>
<text text-anchor="middle" x="248" y="-703.3" font-family="Arial" font-size="14.00">Raw Binary Files</text>
<text text-anchor="middle" x="248" y="-688.3" font-family="Arial" font-size="14.00">Jet detector measurements</text>
<text text-anchor="middle" x="248" y="-673.3" font-family="Arial" font-size="14.00">Float32, Int16, structured</text>
</g>
<!-- train_data -->
<g id="node2" class="node">
<title>train_data</title>
<path fill="#c0ddff" stroke="black" d="M228.5,-628.5C228.5,-628.5 87.5,-628.5 87.5,-628.5 81.5,-628.5 75.5,-622.5 75.5,-616.5 75.5,-616.5 75.5,-602.5 75.5,-602.5 75.5,-596.5 81.5,-590.5 87.5,-590.5 87.5,-590.5 228.5,-590.5 228.5,-590.5 234.5,-590.5 240.5,-596.5 240.5,-602.5 240.5,-602.5 240.5,-616.5 240.5,-616.5 240.5,-622.5 234.5,-628.5 228.5,-628.5"/>
<text text-anchor="middle" x="158" y="-613.3" font-family="Arial" font-size="14.00">Training: atlas_200m.bin</text>
<text text-anchor="middle" x="158" y="-598.3" font-family="Arial" font-size="14.00">200 MB</text>
</g>
<!-- raw_data&#45;&gt;train_data -->
<g id="edge1" class="edge">
<title>raw_data&#45;&gt;train_data</title>
<path fill="none" stroke="black" d="M219.03,-665.09C208.46,-655.64 196.54,-644.97 186.06,-635.6"/>
<polygon fill="black" stroke="black" points="188.15,-632.78 178.37,-628.72 183.49,-637.99 188.15,-632.78"/>
</g>
<!-- test_data -->
<g id="node3" class="node">
<title>test_data</title>
<path fill="#c0ddff" stroke="black" d="M409,-628.5C409,-628.5 271,-628.5 271,-628.5 265,-628.5 259,-622.5 259,-616.5 259,-616.5 259,-602.5 259,-602.5 259,-596.5 265,-590.5 271,-590.5 271,-590.5 409,-590.5 409,-590.5 415,-590.5 421,-596.5 421,-602.5 421,-602.5 421,-616.5 421,-616.5 421,-622.5 415,-628.5 409,-628.5"/>
<text text-anchor="middle" x="340" y="-613.3" font-family="Arial" font-size="14.00">Test Sets:</text>
<text text-anchor="middle" x="340" y="-598.3" font-family="Arial" font-size="14.00">atlas_10m/25m/50m/full</text>
</g>
<!-- raw_data&#45;&gt;test_data -->
<g id="edge2" class="edge">
<title>raw_data&#45;&gt;test_data</title>
<path fill="none" stroke="black" d="M277.36,-665.31C288.36,-655.68 300.83,-644.77 311.73,-635.23"/>
<polygon fill="black" stroke="black" points="314.13,-637.79 319.35,-628.57 309.52,-632.52 314.13,-637.79"/>
</g>
<!-- preprocess -->
<g id="node4" class="node">
<title>preprocess</title>
<path fill="#ffe1cc" stroke="black" d="M250.5,-553.5C250.5,-553.5 95.5,-553.5 95.5,-553.5 89.5,-553.5 83.5,-547.5 83.5,-541.5 83.5,-541.5 83.5,-497.5 83.5,-497.5 83.5,-491.5 89.5,-485.5 95.5,-485.5 95.5,-485.5 250.5,-485.5 250.5,-485.5 256.5,-485.5 262.5,-491.5 262.5,-497.5 262.5,-497.5 262.5,-541.5 262.5,-541.5 262.5,-547.5 256.5,-553.5 250.5,-553.5"/>
<text text-anchor="middle" x="173" y="-538.3" font-family="Arial" font-size="14.00">Preprocessing</text>
<text text-anchor="middle" x="173" y="-523.3" font-family="Arial" font-size="14.00">Sliding windows: 512 bytes</text>
<text text-anchor="middle" x="173" y="-508.3" font-family="Arial" font-size="14.00">Stride: 256 (training)</text>
<text text-anchor="middle" x="173" y="-493.3" font-family="Arial" font-size="14.00">No normalization</text>
</g>
<!-- train_data&#45;&gt;preprocess -->
<g id="edge3" class="edge">
<title>train_data&#45;&gt;preprocess</title>
<path fill="none" stroke="black" d="M161.11,-590.27C162.43,-582.5 164.04,-573.09 165.63,-563.72"/>
<polygon fill="black" stroke="black" points="169.12,-564.1 167.35,-553.65 162.22,-562.92 169.12,-564.1"/>
</g>
<!-- test_data&#45;&gt;preprocess -->
<g id="edge9" class="edge">
<title>test_data&#45;&gt;preprocess</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M305.8,-590.48C288.18,-581.2 266,-569.51 244.84,-558.36"/>
<polygon fill="black" stroke="black" points="246.33,-555.19 235.85,-553.62 243.07,-561.38 246.33,-555.19"/>
</g>
<!-- dataloader -->
<g id="node5" class="node">
<title>dataloader</title>
<path fill="#ffffcc" stroke="black" d="M347.5,-432C347.5,-432 238.5,-432 238.5,-432 232.5,-432 226.5,-426 226.5,-420 226.5,-420 226.5,-376 226.5,-376 226.5,-370 232.5,-364 238.5,-364 238.5,-364 347.5,-364 347.5,-364 353.5,-364 359.5,-370 359.5,-376 359.5,-376 359.5,-420 359.5,-420 359.5,-426 353.5,-432 347.5,-432"/>
<text text-anchor="middle" x="293" y="-416.8" font-family="Arial" font-size="14.00">DataLoader</text>
<text text-anchor="middle" x="293" y="-401.8" font-family="Arial" font-size="14.00">Batch size: 32</text>
<text text-anchor="middle" x="293" y="-386.8" font-family="Arial" font-size="14.00">Shuffle: True (train)</text>
<text text-anchor="middle" x="293" y="-371.8" font-family="Arial" font-size="14.00">Num workers: 2</text>
</g>
<!-- preprocess&#45;&gt;dataloader -->
<g id="edge4" class="edge">
<title>preprocess&#45;&gt;dataloader</title>
<path fill="none" stroke="black" d="M206.43,-485.21C220.73,-470.97 237.56,-454.21 252.56,-439.28"/>
<polygon fill="black" stroke="black" points="255.14,-441.65 259.75,-432.11 250.2,-436.69 255.14,-441.65"/>
</g>
<!-- eval_model -->
<g id="node9" class="node">
<title>eval_model</title>
<path fill="#ccccff" stroke="black" d="M189,-424.5C189,-424.5 49,-424.5 49,-424.5 43,-424.5 37,-418.5 37,-412.5 37,-412.5 37,-383.5 37,-383.5 37,-377.5 43,-371.5 49,-371.5 49,-371.5 189,-371.5 189,-371.5 195,-371.5 201,-377.5 201,-383.5 201,-383.5 201,-412.5 201,-412.5 201,-418.5 195,-424.5 189,-424.5"/>
<text text-anchor="middle" x="119" y="-409.3" font-family="Arial" font-size="14.00">Model Inference</text>
<text text-anchor="middle" x="119" y="-394.3" font-family="Arial" font-size="14.00">No gradient computation</text>
<text text-anchor="middle" x="119" y="-379.3" font-family="Arial" font-size="14.00">Memory persistence</text>
</g>
<!-- preprocess&#45;&gt;eval_model -->
<g id="edge10" class="edge">
<title>preprocess&#45;&gt;eval_model</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M157.96,-485.21C150.71,-469.16 142.01,-449.92 134.68,-433.69"/>
<polygon fill="black" stroke="black" points="137.85,-432.2 130.54,-424.53 131.47,-435.09 137.85,-432.2"/>
</g>
<!-- model_forward -->
<g id="node6" class="node">
<title>model_forward</title>
<path fill="#ccffcc" stroke="black" d="M372,-303C372,-303 244,-303 244,-303 238,-303 232,-297 232,-291 232,-291 232,-262 232,-262 232,-256 238,-250 244,-250 244,-250 372,-250 372,-250 378,-250 384,-256 384,-262 384,-262 384,-291 384,-291 384,-297 378,-303 372,-303"/>
<text text-anchor="middle" x="308" y="-287.8" font-family="Arial" font-size="14.00">Model Forward</text>
<text text-anchor="middle" x="308" y="-272.8" font-family="Arial" font-size="14.00">8&#45;layer transformer</text>
<text text-anchor="middle" x="308" y="-257.8" font-family="Arial" font-size="14.00">Compressive attention</text>
</g>
<!-- dataloader&#45;&gt;model_forward -->
<g id="edge5" class="edge">
<title>dataloader&#45;&gt;model_forward</title>
<path fill="none" stroke="black" d="M297.18,-363.71C299.16,-347.96 301.52,-329.14 303.53,-313.11"/>
<polygon fill="black" stroke="black" points="307.02,-313.39 304.8,-303.03 300.08,-312.52 307.02,-313.39"/>
</g>
<!-- compute_loss -->
<g id="node7" class="node">
<title>compute_loss</title>
<path fill="#bbffbb" stroke="black" d="M342,-174C342,-174 244,-174 244,-174 238,-174 232,-168 232,-162 232,-162 232,-133 232,-133 232,-127 238,-121 244,-121 244,-121 342,-121 342,-121 348,-121 354,-127 354,-133 354,-133 354,-162 354,-162 354,-168 348,-174 342,-174"/>
<text text-anchor="middle" x="293" y="-158.8" font-family="Arial" font-size="14.00">Loss &amp; Metrics</text>
<text text-anchor="middle" x="293" y="-143.8" font-family="Arial" font-size="14.00">Cross&#45;entropy</text>
<text text-anchor="middle" x="293" y="-128.8" font-family="Arial" font-size="14.00">BPD computation</text>
</g>
<!-- model_forward&#45;&gt;compute_loss -->
<g id="edge6" class="edge">
<title>model_forward&#45;&gt;compute_loss</title>
<path fill="none" stroke="black" d="M304.96,-249.8C302.74,-230.95 299.69,-205.11 297.22,-184.25"/>
<polygon fill="black" stroke="black" points="300.68,-183.68 296.03,-174.16 293.73,-184.5 300.68,-183.68"/>
</g>
<!-- backprop -->
<g id="node8" class="node">
<title>backprop</title>
<path fill="#aaffaa" stroke="black" d="M393.5,-69C393.5,-69 292.5,-69 292.5,-69 286.5,-69 280.5,-63 280.5,-57 280.5,-57 280.5,-28 280.5,-28 280.5,-22 286.5,-16 292.5,-16 292.5,-16 393.5,-16 393.5,-16 399.5,-16 405.5,-22 405.5,-28 405.5,-28 405.5,-57 405.5,-57 405.5,-63 399.5,-69 393.5,-69"/>
<text text-anchor="middle" x="343" y="-53.8" font-family="Arial" font-size="14.00">Backpropagation</text>
<text text-anchor="middle" x="343" y="-38.8" font-family="Arial" font-size="14.00">AdamW optimizer</text>
<text text-anchor="middle" x="343" y="-23.8" font-family="Arial" font-size="14.00">LR: 3e&#45;4</text>
</g>
<!-- compute_loss&#45;&gt;backprop -->
<g id="edge7" class="edge">
<title>compute_loss&#45;&gt;backprop</title>
<path fill="none" stroke="black" d="M305.49,-120.77C311.69,-107.99 319.28,-92.36 326.01,-78.5"/>
<polygon fill="black" stroke="black" points="329.28,-79.78 330.5,-69.25 322.98,-76.72 329.28,-79.78"/>
</g>
<!-- backprop&#45;&gt;model_forward -->
<g id="edge8" class="edge">
<title>backprop&#45;&gt;model_forward</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M353.55,-69.05C366.71,-104.95 384.96,-171.69 363,-223 360.04,-229.93 355.66,-236.37 350.65,-242.21"/>
<polygon fill="black" stroke="black" points="347.82,-240.11 343.5,-249.78 352.91,-244.91 347.82,-240.11"/>
<text text-anchor="middle" x="409.5" y="-143.8" font-family="Times,serif" font-size="14.00">50 epochs</text>
</g>
<!-- compute_bpd -->
<g id="node10" class="node">
<title>compute_bpd</title>
<path fill="#bbbbff" stroke="black" d="M158,-295.5C158,-295.5 78,-295.5 78,-295.5 72,-295.5 66,-289.5 66,-283.5 66,-283.5 66,-269.5 66,-269.5 66,-263.5 72,-257.5 78,-257.5 78,-257.5 158,-257.5 158,-257.5 164,-257.5 170,-263.5 170,-269.5 170,-269.5 170,-283.5 170,-283.5 170,-289.5 164,-295.5 158,-295.5"/>
<text text-anchor="middle" x="118" y="-280.3" font-family="Arial" font-size="14.00">Compute BPD</text>
<text text-anchor="middle" x="118" y="-265.3" font-family="Arial" font-size="14.00">On test sets</text>
</g>
<!-- eval_model&#45;&gt;compute_bpd -->
<g id="edge11" class="edge">
<title>eval_model&#45;&gt;compute_bpd</title>
<path fill="none" stroke="black" d="M118.79,-371.36C118.62,-352.06 118.4,-325.62 118.24,-305.72"/>
<polygon fill="black" stroke="black" points="121.74,-305.67 118.15,-295.7 114.74,-305.73 121.74,-305.67"/>
</g>
<!-- results -->
<g id="node11" class="node">
<title>results</title>
<path fill="#ccffcc" stroke="black" d="M179,-189C179,-189 51,-189 51,-189 45,-189 39,-183 39,-177 39,-177 39,-118 39,-118 39,-112 45,-106 51,-106 51,-106 179,-106 179,-106 185,-106 191,-112 191,-118 191,-118 191,-177 191,-177 191,-183 185,-189 179,-189"/>
<text text-anchor="middle" x="115" y="-173.8" font-family="Arial" font-size="14.00">Performance Metrics</text>
<text text-anchor="middle" x="115" y="-158.8" font-family="Arial" font-size="14.00">atlas_10m: 3.044 BPD</text>
<text text-anchor="middle" x="115" y="-143.8" font-family="Arial" font-size="14.00">atlas_25m: 3.043 BPD</text>
<text text-anchor="middle" x="115" y="-128.8" font-family="Arial" font-size="14.00">atlas_50m: 3.042 BPD</text>
<text text-anchor="middle" x="115" y="-113.8" font-family="Arial" font-size="14.00">atlas_full: 3.042 BPD</text>
</g>
<!-- compute_bpd&#45;&gt;results -->
<g id="edge12" class="edge">
<title>compute_bpd&#45;&gt;results</title>
<path fill="none" stroke="black" d="M117.57,-257.3C117.21,-242.17 116.69,-219.86 116.2,-199.38"/>
<polygon fill="black" stroke="black" points="119.7,-199.11 115.96,-189.2 112.7,-199.28 119.7,-199.11"/>
</g>
<!-- baseline -->
<g id="node12" class="node">
<title>baseline</title>
<path fill="#bbffbb" stroke="black" d="M195.5,-69C195.5,-69 28.5,-69 28.5,-69 22.5,-69 16.5,-63 16.5,-57 16.5,-57 16.5,-28 16.5,-28 16.5,-22 22.5,-16 28.5,-16 28.5,-16 195.5,-16 195.5,-16 201.5,-16 207.5,-22 207.5,-28 207.5,-28 207.5,-57 207.5,-57 207.5,-63 201.5,-69 195.5,-69"/>
<text text-anchor="middle" x="112" y="-53.8" font-family="Arial" font-size="14.00">Baseline Comparison</text>
<text text-anchor="middle" x="112" y="-38.8" font-family="Arial" font-size="14.00">Gzip: 5.02 BPD (39% worse)</text>
<text text-anchor="middle" x="112" y="-23.8" font-family="Arial" font-size="14.00">Zstd: 4.98 BPD (39% worse)</text>
</g>
<!-- results&#45;&gt;baseline -->
<g id="edge13" class="edge">
<title>results&#45;&gt;baseline</title>
<path fill="none" stroke="black" d="M113.81,-105.79C113.56,-97 113.29,-87.76 113.04,-79.18"/>
<polygon fill="black" stroke="black" points="116.54,-79 112.75,-69.1 109.54,-79.2 116.54,-79"/>
</g>
</g>
</svg>
