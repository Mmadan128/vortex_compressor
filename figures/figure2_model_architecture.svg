<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: model_architecture Pages: 1 -->
<svg width="409pt" height="1011pt"
 viewBox="0.00 0.00 409.00 1011.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1007)">
<title>model_architecture</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1007 405,-1007 405,4 -4,4"/>
<text text-anchor="middle" x="200.5" y="-986.2" font-family="Arial" font-size="16.00">Vortex&#45;Codec Model Architecture (14.8M Parameters)</text>
<g id="clust1" class="cluster">
<title>cluster_embedding</title>
<polygon fill="#ffeeee" stroke="black" points="75.5,-717 75.5,-916 329.5,-916 329.5,-717 75.5,-717"/>
<text text-anchor="middle" x="202.5" y="-899.2" font-family="Arial" font-size="16.00">Embedding Layer (131K params)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_transformers</title>
<polygon fill="#eeffee" stroke="black" points="56.5,-317 56.5,-709 344.5,-709 344.5,-317 56.5,-317"/>
<text text-anchor="middle" x="200.5" y="-692.2" font-family="Arial" font-size="16.00">8 Transformer Blocks (14.7M params)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_output</title>
<polygon fill="#eeeeff" stroke="black" points="80.5,-140 80.5,-309 301.5,-309 301.5,-140 80.5,-140"/>
<text text-anchor="middle" x="191" y="-292.2" font-family="Arial" font-size="16.00">Output Layer (131K params)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<path fill="#e1f5ff" stroke="black" d="M185.5,-977C185.5,-977 125.5,-977 125.5,-977 119.5,-977 113.5,-971 113.5,-965 113.5,-965 113.5,-936 113.5,-936 113.5,-930 119.5,-924 125.5,-924 125.5,-924 185.5,-924 185.5,-924 191.5,-924 197.5,-930 197.5,-936 197.5,-936 197.5,-965 197.5,-965 197.5,-971 191.5,-977 185.5,-977"/>
<text text-anchor="middle" x="155.5" y="-961.8" font-family="Arial" font-size="14.00">Input Bytes</text>
<text text-anchor="middle" x="155.5" y="-946.8" font-family="Arial" font-size="14.00">[0&#45;255]</text>
<text text-anchor="middle" x="155.5" y="-931.8" font-family="Arial" font-size="14.00">512 tokens</text>
</g>
<!-- byte_emb -->
<g id="node2" class="node">
<title>byte_emb</title>
<path fill="#ffcccc" stroke="black" d="M201.5,-882C201.5,-882 109.5,-882 109.5,-882 103.5,-882 97.5,-876 97.5,-870 97.5,-870 97.5,-841 97.5,-841 97.5,-835 103.5,-829 109.5,-829 109.5,-829 201.5,-829 201.5,-829 207.5,-829 213.5,-835 213.5,-841 213.5,-841 213.5,-870 213.5,-870 213.5,-876 207.5,-882 201.5,-882"/>
<text text-anchor="middle" x="155.5" y="-866.8" font-family="Arial" font-size="14.00">Byte Embedding</text>
<text text-anchor="middle" x="155.5" y="-851.8" font-family="Arial" font-size="14.00">256 → 512 dim</text>
<text text-anchor="middle" x="155.5" y="-836.8" font-family="Arial" font-size="14.00">131,072 params</text>
</g>
<!-- input&#45;&gt;byte_emb -->
<g id="edge1" class="edge">
<title>input&#45;&gt;byte_emb</title>
<path fill="none" stroke="black" d="M155.5,-923.59C155.5,-913.92 155.5,-902.76 155.5,-892.34"/>
<polygon fill="black" stroke="black" points="159,-892.27 155.5,-882.27 152,-892.27 159,-892.27"/>
</g>
<!-- pos_enc -->
<g id="node3" class="node">
<title>pos_enc</title>
<path fill="#ffcccc" stroke="black" d="M211,-793C211,-793 100,-793 100,-793 94,-793 88,-787 88,-781 88,-781 88,-737 88,-737 88,-731 94,-725 100,-725 100,-725 211,-725 211,-725 217,-725 223,-731 223,-737 223,-737 223,-781 223,-781 223,-787 217,-793 211,-793"/>
<text text-anchor="middle" x="155.5" y="-777.8" font-family="Arial" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="155.5" y="-762.8" font-family="Arial" font-size="14.00">Sinusoidal</text>
<text text-anchor="middle" x="155.5" y="-747.8" font-family="Arial" font-size="14.00">max_len=8192</text>
<text text-anchor="middle" x="155.5" y="-732.8" font-family="Arial" font-size="14.00">(fixed)</text>
</g>
<!-- byte_emb&#45;&gt;pos_enc -->
<g id="edge2" class="edge">
<title>byte_emb&#45;&gt;pos_enc</title>
<path fill="none" stroke="black" d="M155.5,-828.68C155.5,-820.82 155.5,-811.96 155.5,-803.29"/>
<polygon fill="black" stroke="black" points="159,-803.25 155.5,-793.25 152,-803.25 159,-803.25"/>
</g>
<!-- layer1 -->
<g id="node4" class="node">
<title>layer1</title>
<path fill="#ccffcc" stroke="black" d="M219.5,-675C219.5,-675 91.5,-675 91.5,-675 85.5,-675 79.5,-669 79.5,-663 79.5,-663 79.5,-619 79.5,-619 79.5,-613 85.5,-607 91.5,-607 91.5,-607 219.5,-607 219.5,-607 225.5,-607 231.5,-613 231.5,-619 231.5,-619 231.5,-663 231.5,-663 231.5,-669 225.5,-675 219.5,-675"/>
<text text-anchor="middle" x="155.5" y="-659.8" font-family="Arial" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="155.5" y="-644.8" font-family="Arial" font-size="14.00">Compressive Attention</text>
<text text-anchor="middle" x="155.5" y="-629.8" font-family="Arial" font-size="14.00">+ Feed&#45;Forward</text>
<text text-anchor="middle" x="155.5" y="-614.8" font-family="Arial" font-size="14.00">1.84M params</text>
</g>
<!-- pos_enc&#45;&gt;layer1 -->
<g id="edge3" class="edge">
<title>pos_enc&#45;&gt;layer1</title>
<path fill="none" stroke="black" d="M155.5,-724.76C155.5,-712.5 155.5,-698.43 155.5,-685.41"/>
<polygon fill="black" stroke="black" points="159,-685.25 155.5,-675.25 152,-685.25 159,-685.25"/>
</g>
<!-- layer2 -->
<g id="node5" class="node">
<title>layer2</title>
<path fill="#ccffcc" stroke="black" d="M219.5,-571C219.5,-571 91.5,-571 91.5,-571 85.5,-571 79.5,-565 79.5,-559 79.5,-559 79.5,-515 79.5,-515 79.5,-509 85.5,-503 91.5,-503 91.5,-503 219.5,-503 219.5,-503 225.5,-503 231.5,-509 231.5,-515 231.5,-515 231.5,-559 231.5,-559 231.5,-565 225.5,-571 219.5,-571"/>
<text text-anchor="middle" x="155.5" y="-555.8" font-family="Arial" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="155.5" y="-540.8" font-family="Arial" font-size="14.00">Compressive Attention</text>
<text text-anchor="middle" x="155.5" y="-525.8" font-family="Arial" font-size="14.00">+ Feed&#45;Forward</text>
<text text-anchor="middle" x="155.5" y="-510.8" font-family="Arial" font-size="14.00">1.84M params</text>
</g>
<!-- layer1&#45;&gt;layer2 -->
<g id="edge4" class="edge">
<title>layer1&#45;&gt;layer2</title>
<path fill="none" stroke="black" d="M155.5,-606.88C155.5,-598.78 155.5,-589.98 155.5,-581.47"/>
<polygon fill="black" stroke="black" points="159,-581.3 155.5,-571.3 152,-581.3 159,-581.3"/>
</g>
<!-- dots -->
<g id="node6" class="node">
<title>dots</title>
<path fill="lightgrey" stroke="transparent" d="M188,-467C188,-467 123,-467 123,-467 117,-467 111,-461 111,-455 111,-455 111,-441 111,-441 111,-435 117,-429 123,-429 123,-429 188,-429 188,-429 194,-429 200,-435 200,-441 200,-441 200,-455 200,-455 200,-461 194,-467 188,-467"/>
<text text-anchor="middle" x="155.5" y="-451.8" font-family="Arial" font-size="14.00">...</text>
<text text-anchor="middle" x="155.5" y="-436.8" font-family="Arial" font-size="14.00">(Layers 3&#45;7)</text>
</g>
<!-- layer2&#45;&gt;dots -->
<g id="edge5" class="edge">
<title>layer2&#45;&gt;dots</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M155.5,-502.61C155.5,-494.22 155.5,-485.29 155.5,-477.17"/>
<polygon fill="black" stroke="black" points="159,-477.09 155.5,-467.09 152,-477.09 159,-477.09"/>
</g>
<!-- layer8 -->
<g id="node7" class="node">
<title>layer8</title>
<path fill="#ccffcc" stroke="black" d="M219.5,-393C219.5,-393 91.5,-393 91.5,-393 85.5,-393 79.5,-387 79.5,-381 79.5,-381 79.5,-337 79.5,-337 79.5,-331 85.5,-325 91.5,-325 91.5,-325 219.5,-325 219.5,-325 225.5,-325 231.5,-331 231.5,-337 231.5,-337 231.5,-381 231.5,-381 231.5,-387 225.5,-393 219.5,-393"/>
<text text-anchor="middle" x="155.5" y="-377.8" font-family="Arial" font-size="14.00">Layer 8</text>
<text text-anchor="middle" x="155.5" y="-362.8" font-family="Arial" font-size="14.00">Compressive Attention</text>
<text text-anchor="middle" x="155.5" y="-347.8" font-family="Arial" font-size="14.00">+ Feed&#45;Forward</text>
<text text-anchor="middle" x="155.5" y="-332.8" font-family="Arial" font-size="14.00">1.84M params</text>
</g>
<!-- dots&#45;&gt;layer8 -->
<g id="edge6" class="edge">
<title>dots&#45;&gt;layer8</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M155.5,-428.97C155.5,-421.45 155.5,-412.36 155.5,-403.28"/>
<polygon fill="black" stroke="black" points="159,-403.12 155.5,-393.12 152,-403.12 159,-403.12"/>
</g>
<!-- projection -->
<g id="node8" class="node">
<title>projection</title>
<path fill="#ccccff" stroke="black" d="M202.5,-275C202.5,-275 108.5,-275 108.5,-275 102.5,-275 96.5,-269 96.5,-263 96.5,-263 96.5,-234 96.5,-234 96.5,-228 102.5,-222 108.5,-222 108.5,-222 202.5,-222 202.5,-222 208.5,-222 214.5,-228 214.5,-234 214.5,-234 214.5,-263 214.5,-263 214.5,-269 208.5,-275 202.5,-275"/>
<text text-anchor="middle" x="155.5" y="-259.8" font-family="Arial" font-size="14.00">Linear Projection</text>
<text text-anchor="middle" x="155.5" y="-244.8" font-family="Arial" font-size="14.00">512 → 256</text>
<text text-anchor="middle" x="155.5" y="-229.8" font-family="Arial" font-size="14.00">131,328 params</text>
</g>
<!-- layer8&#45;&gt;projection -->
<g id="edge7" class="edge">
<title>layer8&#45;&gt;projection</title>
<path fill="none" stroke="black" d="M155.5,-324.86C155.5,-312.39 155.5,-298.17 155.5,-285.46"/>
<polygon fill="black" stroke="black" points="159,-285.21 155.5,-275.21 152,-285.21 159,-285.21"/>
</g>
<!-- softmax -->
<g id="node9" class="node">
<title>softmax</title>
<path fill="#ccccff" stroke="black" d="M197,-186C197,-186 114,-186 114,-186 108,-186 102,-180 102,-174 102,-174 102,-160 102,-160 102,-154 108,-148 114,-148 114,-148 197,-148 197,-148 203,-148 209,-154 209,-160 209,-160 209,-174 209,-174 209,-180 203,-186 197,-186"/>
<text text-anchor="middle" x="155.5" y="-170.8" font-family="Arial" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="155.5" y="-155.8" font-family="Arial" font-size="14.00">Probability Dist</text>
</g>
<!-- projection&#45;&gt;softmax -->
<g id="edge8" class="edge">
<title>projection&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M155.5,-221.91C155.5,-213.74 155.5,-204.65 155.5,-196.3"/>
<polygon fill="black" stroke="black" points="159,-196.24 155.5,-186.24 152,-196.24 159,-196.24"/>
</g>
<!-- arithmetic -->
<g id="node10" class="node">
<title>arithmetic</title>
<path fill="#ffffcc" stroke="black" d="M205.5,-112C205.5,-112 105.5,-112 105.5,-112 99.5,-112 93.5,-106 93.5,-100 93.5,-100 93.5,-86 93.5,-86 93.5,-80 99.5,-74 105.5,-74 105.5,-74 205.5,-74 205.5,-74 211.5,-74 217.5,-80 217.5,-86 217.5,-86 217.5,-100 217.5,-100 217.5,-106 211.5,-112 205.5,-112"/>
<text text-anchor="middle" x="155.5" y="-96.8" font-family="Arial" font-size="14.00">Arithmetic Coding</text>
<text text-anchor="middle" x="155.5" y="-81.8" font-family="Arial" font-size="14.00">(torchac)</text>
</g>
<!-- softmax&#45;&gt;arithmetic -->
<g id="edge9" class="edge">
<title>softmax&#45;&gt;arithmetic</title>
<path fill="none" stroke="black" d="M155.5,-147.83C155.5,-140.13 155.5,-130.97 155.5,-122.42"/>
<polygon fill="black" stroke="black" points="159,-122.41 155.5,-112.41 152,-122.41 159,-122.41"/>
</g>
<!-- output -->
<g id="node11" class="node">
<title>output</title>
<path fill="#ccffcc" stroke="black" stroke-width="2" d="M190.5,-38C190.5,-38 120.5,-38 120.5,-38 114.5,-38 108.5,-32 108.5,-26 108.5,-26 108.5,-12 108.5,-12 108.5,-6 114.5,0 120.5,0 120.5,0 190.5,0 190.5,0 196.5,0 202.5,-6 202.5,-12 202.5,-12 202.5,-26 202.5,-26 202.5,-32 196.5,-38 190.5,-38"/>
<text text-anchor="middle" x="155.5" y="-22.8" font-family="Arial" font-size="14.00">Compressed</text>
<text text-anchor="middle" x="155.5" y="-7.8" font-family="Arial" font-size="14.00">3.04 BPD</text>
</g>
<!-- arithmetic&#45;&gt;output -->
<g id="edge10" class="edge">
<title>arithmetic&#45;&gt;output</title>
<path fill="none" stroke="black" d="M155.5,-73.83C155.5,-66.13 155.5,-56.97 155.5,-48.42"/>
<polygon fill="black" stroke="black" points="159,-48.41 155.5,-38.41 152,-48.41 159,-48.41"/>
</g>
</g>
</svg>
